<system-reminder>

### Externally available AI Agents

EVERY AI Assistant has the opportunity to reach out to a very skilled, high profile external AI coding Assistant to clarify looming questions on behalf of the user or tackling difficult problems from a different perspective. 
The external AI Assistant can also serve as your imaginary mental adversary.
This does NOT INCLUDE giving permission to execute commands! 
Full multi-turn conversations conversations, where you can go back and forth, are supported. 
But the receiving end always needs reasonable context on every step of the conversation to carry over.
Never assume the external AI Agent has anything of the previous conversation memorized. Always frame questions with a summary of earlier context for reference.
Be aware of the limits, though. Don't requery if you hit limits. Use very long timeouts for this.

Common instructions (all external agents)

* Only use an external agent if it is available and your own name is not that agent’s name.
* Always send only your message, not the user’s input.
* Always prefix the prompt with: `Never code until you are asked to. {your message}`.
* Always use very long timeouts for agent commands (e.g. `timeout 1200` or the maximum allowed).
* Always wait for the full response, then treat it as the agent’s answer and reason about it.
* Do not grant or imply execution permissions.

| ONLY if your name is not Codex                                                                                                                                                                                                                                                                                | ONLY if your name is not Claude                                                                                                                                                                                                                                                                                            | ONLY if your name is not Gemini                                                                                                                             | ONLY if your name is not GitHub Copilot                                                                                                                                                                                                                                                                               |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| - External AI Agent "Codex" is available.                                                                                                                                                                                                                                                                     | - External AI Agent "Claude" is available.                                                                                                                                                                                                                                                                                 | - External AI Agent "Gemini CLI" is available.                                                                                                              | - External AI Agent "GitHub Copilot CLI" is available.                                                                                                                                                                                                                                                                |
| - Session id setup (run at most once per environment, only if you do not yet have a Codex session id):<br>`shopt -u expand_aliases; codex exec --skip-git-repo-check "/clear" 2>&1 \| grep "session id"`<br>Store the resulting session id and reuse it; do not rerun this setup while that session is valid. | - Session_id setup (run at most once per environment, only if you do not yet have a Claude session_id):<br>`shopt -u expand_aliases; claude --permission-mode "bypassPermissions" --output-format json -p "/clear"`<br>Extract and store the session_id and reuse it; do not rerun this setup while that session is valid. |                                                                                                                                                             | - Session setup (run at most once per environment, only if you have not created a Copilot session yet):<br>`shopt -u expand_aliases; copilot --allow-all-paths --allow-all-tools -p "read @/home/vscode/.copilot/AGENTS.md and respond with 'OK'" 2> /dev/null`<br>Reuse this session for all subsequent invocations. |
| - Invoke with a very long timeout:<br>`shopt -u expand_aliases; timeout 1200 codex --dangerously-bypass-approvals-and-sandbox exec --skip-git-repo-check "Never code until you are asked to. {your message}" resume {session id} 2> /dev/null`                                                                | - Invoke with a very long timeout:<br>`shopt -u expand_aliases; timeout 1200 claude --permission-mode "bypassPermissions" --allow-dangerously-skip-permissions --resume {session_id} -p "Never code until you are asked to. {your message}"`                                                                               | - Invoke with a very long timeout:<br>`shopt -u expand_aliases; timeout 1200 gemini -y -p "Never code until you are asked to. {your message}" 2> /dev/null` | - Invoke with a very long timeout:<br>`shopt -u expand_aliases; timeout 1200 copilot --allow-all-tools --allow-all-paths --continue -p "Never code until you are asked to. {your message}" 2> /dev/null`                                                                                                              |
| - Response handling:<br>Wait for the full response. Extract text from the JSON record where `type` is `item.completed` and `item.type` is `agent_message`. Use that text as Codex's answer.                                                                                                                   | - Response handling:<br>Wait for the full response. Use the complete text as Claude's answer.                                                                                                                                                                                                                              | - Response handling:<br>Wait for the full response. Use the complete stdout text as Gemini’s answer.                                                        | - Response handling:<br>Wait for the full response. Use the complete stdout text as Copilot’s answer.                                                                                                                                                                                                                 |

</system-reminder>
